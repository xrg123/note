### 1、B(B-)、B+树

B树是一种平衡的多路查找树，其每个节点具有比二叉树多得多的元素，所以其减少了访问节点和数据块的数量，从而提高了性能。B树的数据结构就是为内外存数据交互准备的。B树具有如下属性：

*如果根节点不是叶节点，其至少有两棵子树

*每一个非根的分支节点都有k个孩子和k-1个关键字，m/2 <= k <= m, 每个叶子节点都有k-1个关键字。

*所有叶子节点位于同一层次

*节点的结构为：第一个数字表示节点关键字个数，接下来以此为指针，关键字，指针，关键字……关键字从左到右一次增大



B+树是B树的一种变形树，B+树结构特别适合带有范围的查找其特征如下：

*除根节点外，有n棵子树的节点种包含n个关键字

*所有的叶子节点包含全部关键字信息，每一个叶子节点包含只想后一个叶子节点的指针，叶子节点种的关键字自小向大连接

*所有的分支节点可以看成是索引，节点中含有树中的最大关键字



红黑树是一种平衡的二叉查找树，除了二叉树的基本特征外，还具有5种特征：

*每个节点要么是红的，要么是黑的

*根节点是黑的

*叶子节点是黑的空节点

*红节点的子节点是黑的

*节点到叶子节点的每条路径黑节点数目相同

当进行插入或删除操作时，会破坏这些规则，通过变色或旋转来进行调整

<http://www.360doc.com/content/18/0904/19/25944647_783893127.shtml>

### 2、红黑树和平衡二叉树（AVL)的区别

AVL是带有平衡条件的二叉查找树，通过平衡因子差值判断是否平衡，并通过旋转来实现平衡。和红黑树相比，AVL是严格的平衡二叉树，不管是插入还是删除操作，必须满足平衡条件（左右子树高度差的绝对值不超过1）。AVL维持高度平衡所付出的代价比较大，适用于查找多增删少的情景，其查找速度优于红黑树。

红黑树是一种二叉查找树，每个节点增加一个存储位表示节点颜色，通过对任何一条从节点到叶子节点路径黑色节点数量相同的限制，确保没有一条路径会比其他路径长出两倍。因此红黑树是一种弱平衡二叉树（红黑树追求局部平衡而不是整体严格平衡）。由于是弱平衡，在节点相同的情况下，红黑树的高度低于AVL的高度，相对于严格AVL来说，它的旋转次数更少。所以在插入、删除较多的情况下，就用红黑树。

红黑树用途：linux进程完全公平调度、IO多路复用epoll的实现用红黑树管理sockfd、nginx中用红黑树管理定时器、java中hashMap/TreeMap

### 3、跳表

跳表是一种可以进行二分查找的有序链表，跳表在原有的有序链表上面增加了多级索引，通过索引来实现快速查找，同时也可提高插入和删除操作的性能。

标准化的跳表每两个元素提取一个元素作为上一级的索引，其时间复杂度为O(logn),空间复杂度为O(n)

## 总结

（1）跳表是可以实现二分查找的有序链表；

（2）每个元素插入时随机生成它的level；

（3）最低层包含所有的元素；

（4）如果一个元素出现在level(x)，那么它肯定出现在x以下的level中；

（5）每个索引节点包含两个指针，一个向下，一个向右；

（6）跳表查询、插入、删除的时间复杂度为O(log n)，与平衡二叉树接近；

为什么Redis选择使用跳表而不是红黑树来实现有序集合？

首先，我们来分析下Redis的有序集合支持的操作：

1）插入元素

2）删除元素

3）查找元素

4）有序输出所有元素

5）查找区间内所有元素

其中，前4项红黑树都可以完成，且时间复杂度与跳表一致。

但是，最后一项，红黑树的效率就没有跳表高了。

在跳表中，要查找区间的元素，我们只要定位到两个区间端点在最低层级的位置，然后按顺序遍历元素就可以了，非常高效。

而红黑树只能定位到端点后，再从首位置开始每次都要查找后继节点，相对来说是比较耗时的。

此外，跳表实现起来很容易且易读，红黑树实现起来相对困难，所以Redis选择使用跳表来实现有序集合。